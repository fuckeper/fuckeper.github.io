–û—Ç–ª–∏—á–Ω—ã–π –ª–æ–≥ ‚Äî –∏ —Ç–µ–ø–µ—Ä—å –≤—Å—ë –ø—Ä–µ–¥–µ–ª—å–Ω–æ —è—Å–Ω–æ! üëç

---

## ‚úÖ –ß—Ç–æ –≤–∏–¥–Ω–æ –∏–∑ –ª–æ–≥–æ–≤:

–¢–≤–æ–π backend **—É–∂–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç** –∏ **–ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Ä–∞–Ω–µ–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ cookies**. –ü—Ä–∏–º–µ—Ä:

```
"Previously processed cookies skipped"
"All cookies have been already processed"
```

–ê –∑–Ω–∞—á–∏—Ç, —É —Ç–µ–±—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ö–∞–Ω–∏–∑–º –∫–µ—à–∞ –∏–ª–∏ –∏—Å—Ç–æ—Ä–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ ‚Äî —ç—Ç–æ –∫—Ä—É—Ç–æ.

---

## ‚ùó –ù–æ –µ—Å—Ç—å —Å—Ç—Ä–∞–Ω–Ω–æ—Å—Ç—å: –ø–æ—á–µ–º—É —Å–µ—Ä–≤–µ—Ä **–º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∑–∞–ø—Ä–æ—Å –∑–∞ –¥–æ–ª–∏ —Å–µ–∫—É–Ω–¥—ã?**

```text
09:54:04.576
09:54:04.734
09:54:04.742
09:54:04.751
09:54:04.758
```

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ 5‚Äì6 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö POST-–∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ –æ–¥–Ω—É —Å–µ–∫—É–Ω–¥—É.

---

## üí° –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:

### 1. üö® **–§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –≤ —Ü–∏–∫–ª–µ / –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–º —Ä–µ–∂–∏–º–µ**
–ú–æ–∂–µ—Ç –±—ã—Ç—å, –∫–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–∫–∞, –∏–ª–∏ –≤ –∫–æ–¥–µ frontend'–∞ —Å—Ç–æ–∏—Ç —Ü–∏–∫–ª `forEach(cookie => sendValidate(cookie))`.

### 2. üîÅ **–ê–≤—Ç–æ-—Ä–µ—Å–µ–Ω–¥–µ—Ä –∏–ª–∏ useEffect –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–≤ React)**
–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è React ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, `useEffect` –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤—ã–∑—ã–≤–∞–µ—Ç `fetch()` –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ.

### 3. üîÑ **–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∏–∑-–∑–∞ —Ç–∞–π–º–µ—Ä–∞, WebSocket –∏–ª–∏ polling'–∞**
–ï—Å–ª–∏ —Ñ—Ä–æ–Ω—Ç –ø–∏–Ω–≥—É–µ—Ç `/api/validate` –∫–∞–∂–¥—ã–µ X —Å–µ–∫—É–Ω–¥ ‚Äî –∑–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å—Å—è.

---

## ‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å:

### 1. üîí –î–æ–±–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ (–¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è):

–ù–∞ **frontend**:
```js
let isValidating = false;

async function validateCookies(cookies) {
  if (isValidating) return;
  isValidating = true;

  try {
    await fetch("/api/validate", { method: "POST", body: JSON.stringify({ cookies }) });
  } finally {
    isValidating = false;
  }
}
```

---

### 2. üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–∞ **backend** (–≤ Express):

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Ç–æ–∫–µ–Ω/ID –∑–∞–ø—Ä–æ—Å–∞:
```ts
const activeRequests = new Set();

app.post('/api/validate', (req, res) => {
  const hash = JSON.stringify(req.body.cookies); // –∏–ª–∏ UUID
  if (activeRequests.has(hash)) {
    return res.status(429).json({ message: "Duplicate validation request detected" });
  }
  activeRequests.add(hash);

  // continue processing
  res.on('finish', () => {
    activeRequests.delete(hash);
  });
});
```

---

### 3. üîç –õ–æ–≥–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞:

–ï—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å —Ç–æ—á–Ω–µ–µ –ø–æ–Ω—è—Ç—å, **–ø–æ—á–µ–º—É —ç—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è**, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥ IP-–∞–¥—Ä–µ—Å–∞ + user-agent:

```js
console.log(`[VALIDATE] ${req.ip} - ${req.headers['user-agent']} at ${Date.now()}`);
```

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî —è –º–æ–≥—É –ø–æ–º–æ—á—å —Ä–∞–∑–æ–±—Ä–∞—Ç—å —Ç–≤–æ–π frontend –∏–ª–∏ middleware, —á—Ç–æ–±—ã —Ç–æ—á–Ω–æ –ø–æ–Ω—è—Ç—å, –≥–¥–µ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤—ã–∑–æ–≤. –ü—Ä–æ—Å—Ç–æ —Å–∫–∏–Ω—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç ‚Äî —Ä–∞–∑–±–µ—Ä—ë–º—Å—è üíªüõ†Ô∏è